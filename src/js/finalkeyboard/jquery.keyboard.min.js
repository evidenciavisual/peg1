/*!
jQuery UI Virtual Keyboard
Version 1.14 minified (MIT License)
Caret code modified from jquery.caret.1.02.js (MIT License)
*/
;(function(d){d.keyboard=function(b,l){var a=this,e;a.$el=d(b);a.el=b;a.$el.data("keyboard",a);a.init=function(){a.options=e=d.extend(!0,{},d.keyboard.defaultOptions,l);a.shiftActive=a.altActive=a.metaActive=a.sets=a.capsLock=!1;a.lastKeyset=[!1,!1,!1];a.rows=["","-shift","-alt","-alt-shift"];a.acceptedKeys=[];a.mappedKeys={};d('<\!--[if lte IE 8]><script>jQuery("body").addClass("oldie");<\/script><![endif]--\><\!--[if IE]><script>jQuery("body").addClass("ie");<\/script><![endif]--\>').appendTo("body").remove(); a.msie=d("body").hasClass("oldie");a.allie=d("body").hasClass("ie");a.inPlaceholder=a.$el.attr("placeholder")||"";a.watermark="undefined"!==typeof document.createElement("input").placeholder&&""!==a.inPlaceholder;a.regex=d.keyboard.comboRegex;a.decimal=/^\./.test(e.display.dec)?!0:!1;a.repeatTime=1E3/(e.repeatRate||20);a.temp=d('<input style="position:absolute;left:-9999em;top:-9999em;" type="text" value="testing">').appendTo("body").caret(3,3);a.checkCaret=e.lockInput||3!==a.temp.hide().show().caret().start? !0:!1;a.temp.remove();a.lastCaret={start:0,end:0};a.temp=["",0,0];d.each("initialized visible change hidden canceled accepted beforeClose".split(" "),function(c,i){d.isFunction(e[i])&&a.$el.bind(i+".keyboard",e[i])});e.alwaysOpen&&(e.stayOpen=!0);d(document).bind("mousedown.keyboard keyup.keyboard",function(c){if(!a.opening){a.escClose(c);if(c.target&&d(c.target).hasClass("ui-keyboard-input"))(c=d(c.target).data("keyboard"))&&c.options.openOn&&c.focusOn()}});a.$el.addClass("ui-keyboard-input "+e.css.input).attr({"aria-haspopup":"true", role:"textbox"});(a.$el.is(":disabled")||a.$el.attr("readonly")&&!a.$el.hasClass("ui-keyboard-lockedinput"))&&a.$el.addClass("ui-keyboard-nokeyboard");e.openOn&&a.$el.bind(e.openOn+".keyboard",function(){a.focusOn()});!a.watermark&&(""===a.$el.val()&&""!==a.inPlaceholder&&""!==a.$el.attr("placeholder"))&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder);a.$el.trigger("initialized.keyboard",[a,a.el]);e.alwaysOpen&&a.reveal()};a.focusOn=function(){a.$el.is(":visible")&&(a.lastCaret=a.$el.caret()); if(!a.isVisible()||e.alwaysOpen)clearTimeout(a.timer),a.reveal(),setTimeout(function(){a.$preview.focus()},100)};a.reveal=function(){a.opening=!0;d(".ui-keyboard:not(.ui-keyboard-always-open)").hide();if(a.$el.is(":disabled")||a.$el.attr("readonly")&&!a.$el.hasClass("ui-keyboard-lockedinput"))a.$el.addClass("ui-keyboard-nokeyboard");else{a.$el.removeClass("ui-keyboard-nokeyboard");e.openOn&&a.$el.unbind(e.openOn+".keyboard");"undefined"===typeof a.$keyboard&&a.startup();d(".ui-keyboard-has-focus").removeClass("ui-keyboard-has-focus"); d(".ui-keyboard-input-current").removeClass("ui-keyboard-input-current");a.$el.addClass("ui-keyboard-input-current");a.isCurrent(!0);!a.watermark&&a.el.value===a.inPlaceholder&&a.$el.removeClass("ui-keyboard-placeholder").val("");a.originalContent=a.$el.val();a.$preview.val(a.originalContent);e.acceptValid&&a.checkValid();var c;a.position=e.position;a.position.of=a.position.of||a.$el.data("keyboardPosition")||a.$el;a.position.collision=e.usePreview?a.position.collision||"fit fit":"flip flip";e.resetDefault&& (a.shiftActive=a.altActive=a.metaActive=!1,a.showKeySet());a.$keyboard.css({position:"absolute",left:0,top:0}).addClass("ui-keyboard-has-focus").show();e.usePreview&&a.msie&&("undefined"===typeof a.width&&(a.$preview.hide(),a.width=Math.ceil(a.$keyboard.width()),a.$preview.show()),a.$preview.width(a.width));a.$keyboard.position(a.position);a.$preview.focus();a.checkDecimal();a.lineHeight=parseInt(a.$preview.css("lineHeight"),10)||parseInt(a.$preview.css("font-size"),10)+4;if(a.allie&&(c=a.lastCaret.start|| a.originalContent.length,c={start:c,end:c},a.lastCaret||(a.lastCaret=c),0===a.lastCaret.end&&0<a.lastCaret.start&&(a.lastCaret.end=a.lastCaret.start),0>a.lastCaret.start))a.lastCaret=c;a.$preview.caret(a.lastCaret.start,a.lastCaret.end);a.$el.trigger("visible.keyboard",[a,a.el]);setTimeout(function(){a.opening=false},500);return a}};a.startup=function(){a.$keyboard=a.buildKeyboard();a.$allKeys=a.$keyboard.find("button.ui-keyboard-button");a.preview=a.$preview[0];a.$decBtn=a.$keyboard.find(".ui-keyboard-dec"); a.wheel=d.isFunction(d.fn.mousewheel);a.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46];e.enterNavigation&&a.alwaysAllowed.push(13);a.$preview.bind("keypress.keyboard",function(c){var i=String.fromCharCode(c.charCode||c.which);a.checkCaret&&(a.lastCaret=a.$preview.caret());a.capsLock=65<=i&&90>=i&&!c.shiftKey||97<=i&&122>=i&&c.shiftKey?!0:!1;if(e.restrictInput){if((8===c.which||0===c.which)&&d.inArray(c.keyCode,a.alwaysAllowed))return;-1===d.inArray(i,a.acceptedKeys)&&c.preventDefault()}else if((c.ctrlKey|| c.metaKey)&&(97===c.which||99===c.which||118===c.which||120<=c.which&&122>=c.which))return;a.hasMappedKeys&&a.mappedKeys.hasOwnProperty(i)&&(a.insertText(a.mappedKeys[i]),c.preventDefault());a.checkMaxLength()}).bind("keyup.keyboard",function(c){switch(c.which){case 9:a.tab&&!e.lockInput?(d.keyboard.keyaction.tab(a),a.tab=!1):c.preventDefault();break;case 27:return a.close(),!1}clearTimeout(a.throttled);a.throttled=setTimeout(function(){a.isVisible()&&a.checkCombos()},100);a.checkMaxLength();a.$el.trigger("change.keyboard", [a,a.el])}).bind("keydown.keyboard",function(c){switch(c.which){case 9:if(e.tabNavigation)return!0;a.tab=!0;return!1;case 13:d.keyboard.keyaction.enter(a,null,c);break;case 20:a.shiftActive=a.capsLock=!a.capsLock;a.showKeySet(this);break;case 86:if(c.ctrlKey||c.metaKey){if(e.preventPaste){c.preventDefault();break}a.checkCombos()}}}).bind("mouseup.keyboard",function(){a.checkCaret&&(a.lastCaret=a.$preview.caret())});a.$keyboard.bind("mousedown.keyboard click.keyboard",function(a){a.stopPropagation()}); e.preventPaste&&(a.$preview.bind("contextmenu.keyboard",function(a){a.preventDefault()}),a.$el.bind("contextmenu.keyboard",function(a){a.preventDefault()}));e.appendLocally?a.$el.after(a.$keyboard):a.$keyboard.appendTo("body");a.$allKeys.bind(e.keyBinding.split(" ").join(".keyboard ")+".keyboard repeater.keyboard",function(c){var i;i=d.data(this,"key");var b=i.action.split(":")[0];a.$preview.focus();a.checkCaret&&a.$preview.caret(a.lastCaret.start,a.lastCaret.end);b.match("meta")&&(b="meta");if(d.keyboard.keyaction.hasOwnProperty(b)&& d(this).hasClass("ui-keyboard-actionkey")){if(d.keyboard.keyaction[b](a,this,c)===false)return}else if(typeof i.action!=="undefined"){i=a.wheel&&!d(this).hasClass("ui-keyboard-actionkey")?i.curTxt:i.action;a.insertText(i);if(!a.capsLock&&!e.stickyShift&&!c.shiftKey){a.shiftActive=false;a.showKeySet(this)}}a.checkCombos();a.checkMaxLength();a.$el.trigger("change.keyboard",[a,a.el]);a.$preview.focus();c.preventDefault()}).bind("mouseenter.keyboard mouseleave.keyboard",function(c){var i=d(this),b=d.data(this, "key");c.type==="mouseenter"&&a.el.type!=="password"&&i.addClass(e.css.buttonHover).attr("title",function(c,i){return a.wheel&&i===""&&a.sets?e.wheelMessage:i});if(c.type==="mouseleave"){b.curTxt=b.original;b.curNum=0;d.data(this,"key",b);i.removeClass(a.el.type==="password"?"":e.css.buttonHover).attr("title",function(a,c){return c===e.wheelMessage?"":c}).find("span").text(b.original)}}).bind("mousewheel.keyboard",function(c,i){if(a.wheel){var e,b=d(this),f=d.data(this,"key");e=f.layers||a.getLayers(b); f.curNum=f.curNum+(i>0?-1:1);if(f.curNum>e.length-1)f.curNum=0;if(f.curNum<0)f.curNum=e.length-1;f.layers=e;f.curTxt=e[f.curNum];d.data(this,"key",f);b.find("span").text(e[f.curNum]);return false}}).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb",function(){a.isVisible()&&a.isCurrent()&&a.$preview.focus();a.mouseRepeat=[false,""];clearTimeout(a.repeater);a.checkCaret&&a.$preview.caret(a.lastCaret.start,a.lastCaret.end);return false}).bind("click.keyboard",function(){return false}).filter(":not(.ui-keyboard-actionkey)").add(".ui-keyboard-tab, .ui-keyboard-bksp, .ui-keyboard-space, .ui-keyboard-enter", a.$keyboard).bind("mousedown.kb touchstart.kb",function(){if(e.repeatRate!==0){var c=d(this);a.mouseRepeat=[true,c];setTimeout(function(){a.mouseRepeat[0]&&a.mouseRepeat[1]===c&&a.repeatKey(c)},e.repeatDelay)}return false});d(window).resize(function(){a.isVisible()&&a.$keyboard.position(a.position)})};a.isVisible=function(){return"undefined"===typeof a.$keyboard?!1:a.$keyboard.is(":visible")};a.insertText=function(c){var e,b;b=a.$preview.val();var d=a.$preview.caret(),f=a.$preview.scrollLeft();e= a.$preview.scrollTop();var g=b.length;d.end<d.start&&(d.end=d.start);d.start>g&&(d.end=d.start=g);"TEXTAREA"===a.preview.tagName&&(a.msie&&"\n"===b.substr(d.start,1)&&(d.start+=1,d.end+=1),b=b.split("\n").length-1,a.preview.scrollTop=0<b?a.lineHeight*b:e);e="bksp"===c&&d.start===d.end?!0:!1;c="bksp"===c?"":c;b=d.start+(e?-1:c.length);f+=parseInt(a.$preview.css("fontSize"),10)*("bksp"===c?-1:1);a.$preview.val(a.$preview.val().substr(0,d.start-(e?1:0))+c+a.$preview.val().substr(d.end)).caret(b,b).scrollLeft(f); a.checkCaret&&(a.lastCaret={start:b,end:b})};a.checkMaxLength=function(){var c,i=a.$preview.val();!1!==e.maxLength&&i.length>e.maxLength&&(c=Math.min(a.$preview.caret().start,e.maxLength),a.$preview.val(i.substring(0,e.maxLength)),a.$preview.caret(c,c),a.lastCaret={start:c,end:c});a.$decBtn.length&&a.checkDecimal()};a.repeatKey=function(c){c.trigger("repeater.keyboard");a.mouseRepeat[0]&&(a.repeater=setTimeout(function(){a.repeatKey(c)},a.repeatTime))};a.showKeySet=function(c){var i="",b=(a.shiftActive? 1:0)+(a.altActive?2:0);a.shiftActive||(a.capsLock=!1);if(a.metaActive){if(i=c&&c.name&&/meta/.test(c.name)?c.name:"",""===i?i=!0===a.metaActive?"":a.metaActive:a.metaActive=i,!e.stickyShift&&a.lastKeyset[2]!==a.metaActive||(a.shiftActive||a.altActive)&&!a.$keyboard.find(".ui-keyboard-keyset-"+i+a.rows[b]).length)a.shiftActive=a.altActive=!1}else!e.stickyShift&&(a.lastKeyset[2]!==a.metaActive&&a.shiftActive)&&(a.shiftActive=a.altActive=!1);b=(a.shiftActive?1:0)+(a.altActive?2:0);i=0===b&&!a.metaActive? "-default":""===i?"":"-"+i;a.$keyboard.find(".ui-keyboard-keyset"+i+a.rows[b]).length?(a.$keyboard.find(".ui-keyboard-alt, .ui-keyboard-shift, .ui-keyboard-actionkey[class*=meta]").removeClass(e.css.buttonAction).end().find(".ui-keyboard-alt")[a.altActive?"addClass":"removeClass"](e.css.buttonAction).end().find(".ui-keyboard-shift")[a.shiftActive?"addClass":"removeClass"](e.css.buttonAction).end().find(".ui-keyboard-lock")[a.capsLock?"addClass":"removeClass"](e.css.buttonAction).end().find(".ui-keyboard-keyset").hide().end().find(".ui-keyboard-keyset"+ i+a.rows[b]).show().end().find(".ui-keyboard-actionkey.ui-keyboard"+i).addClass(e.css.buttonAction),a.lastKeyset=[a.shiftActive,a.altActive,a.metaActive]):(a.shiftActive=a.lastKeyset[0],a.altActive=a.lastKeyset[1],a.metaActive=a.lastKeyset[2])};a.checkCombos=function(){var c,b,d,h,f=a.$preview.val(),g=a.$preview.caret(),j=f.length;g.end<g.start&&(g.end=g.start);g.start>j&&(g.end=g.start=j);a.msie&&"\n"===f.substr(g.start,1)&&(g.start+=1,g.end+=1);e.useCombos&&(a.msie?f=f.replace(a.regex,function(a, c,b){return e.combos.hasOwnProperty(c)?e.combos[c][b]||a:a}):(d=g.start-(0<=g.start-2?2:0),a.$preview.caret(d,g.end),h=a.$preview.caret().text.replace(a.regex,function(a,c,b){return e.combos.hasOwnProperty(c)?e.combos[c][b]||a:a}),a.$preview.val(a.$preview.caret().replace(h)),f=a.$preview.val()));if(e.restrictInput&&""!==f){d=f;b=a.acceptedKeys.length;for(c=0;c<b;c++)""!==d&&(h=a.acceptedKeys[c],0<=f.indexOf(h)&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(h)&&(h="\\"+h),d=d.replace(RegExp(h, "g"),"")));""!==d&&(f=f.replace(d,""))}g.start+=f.length-j;g.end+=f.length-j;a.$preview.val(f);a.$preview.caret(g.start,g.end);a.preview.scrollTop=a.lineHeight*(f.substring(0,g.start).split("\n").length-1);a.lastCaret={start:g.start,end:g.end};e.acceptValid&&a.checkValid();return f};a.checkValid=function(){var c=!0;e.validate&&"function"===typeof e.validate&&(c=e.validate(a,a.$preview.val(),!1));a.$keyboard.find(".ui-keyboard-accept")[c?"removeClass":"addClass"]("ui-keyboard-invalid-input")[c?"addClass": "removeClass"]("ui-keyboard-valid-input")};a.checkDecimal=function(){a.decimal&&/\./g.test(a.preview.value)||!a.decimal&&/\,/g.test(a.preview.value)?a.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(e.css.buttonDefault+" "+e.css.buttonHover).addClass(e.css.buttonDisabled):a.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(e.css.buttonDefault).removeClass(e.css.buttonDisabled)};a.getLayers=function(a){var e;e=a.attr("data-pos");return a.closest(".ui-keyboard").find('button[data-pos="'+ e+'"]').map(function(){return d(this).find("> span").text()}).get()};a.isCurrent=function(c){var e=d.keyboard.currentKeyboard||!1;c?e=d.keyboard.currentKeyboard=a.el:!1===c&&e===a.el&&(e=d.keyboard.currentKeyboard="");return e===a.el};a.switchInput=function(c,b){if("function"===typeof e.switchInput)e.switchInput(a,c,b);else{var k;k=!1;var h=d(".ui-keyboard-input:visible"),f=h.index(a.$el)+(c?1:-1);f>h.length-1&&(k=e.stopAtEnd,f=0);0>f&&(k=e.stopAtEnd,f=h.length-1);k||(a.close(b),(k=h.eq(f).data("keyboard"))&& k.options.openOn.length&&k.focusOn())}return!1};a.close=function(c){if(a.isVisible()){clearTimeout(a.throttled);var b=c?a.checkCombos():a.originalContent;if(c&&(e.validate&&"function"===typeof e.validate&&!e.validate(a,b,!0))&&(b=a.originalContent,c=!1,e.cancelClose))return;a.isCurrent(!1);a.$el.removeClass("ui-keyboard-input-current ui-keyboard-autoaccepted").addClass(c?!0===c?"":"ui-keyboard-autoaccepted":"").trigger(e.alwaysOpen?"":"beforeClose.keyboard",[a,a.el,c||!1]).val(b).scrollTop(a.el.scrollHeight).trigger(c? "accepted.keyboard":"canceled.keyboard",[a,a.el]).trigger(e.alwaysOpen?"inactive.keyboard":"hidden.keyboard",[a,a.el]).blur();e.openOn&&(a.timer=setTimeout(function(){a.$el.bind(e.openOn+".keyboard",function(){a.focusOn()});d(":focus")[0]===a.el&&a.$el.blur()},500));e.alwaysOpen||a.$keyboard.hide();!a.watermark&&(""===a.el.value&&""!==a.inPlaceholder)&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder)}return!!c};a.accept=function(){return a.close(!0)};a.escClose=function(c){if("keyup"=== c.type)return 27===c.which?a.close():"";var b=a.isCurrent();if(a.isVisible()&&!(e.alwaysOpen&&!b||!e.alwaysOpen&&e.stayOpen&&b&&!a.isVisible())&&c.target!==a.el&&b)a.allie&&c.preventDefault(),a.close(e.autoAccept?"true":!1)};a.keyBtn=d("<button />").attr({role:"button","aria-disabled":"false",tabindex:"-1"}).addClass("ui-keyboard-button");a.addKey=function(c,b,k){var h,f,g,b=!0===k?c:e.display[b]||c,j=!0===k?c.charCodeAt(0):c;/\(.+\)/.test(b)&&(f=b.replace(/\(([^()]+)\)/,""),h=b.match(/\(([^()]+)\)/)[1], b=f,g=f.split(":"),f=""!==g[0]&&1<g.length?g[0]:f,a.mappedKeys[h]=f);g=b.split(":");""===g[0]&&""===g[1]&&(b=":");b=""!==g[0]&&1<g.length?d.trim(g[0]):b;h=1<g.length?d.trim(g[1]).replace(/_/g," ")||"":"";f=1<b.length?" ui-keyboard-widekey":"";f+=k?"":" ui-keyboard-actionkey";return a.keyBtn.clone().attr({"data-value":b,name:j,"data-pos":a.temp[1]+","+a.temp[2],title:h}).data("key",{action:c,original:b,curTxt:b,curNum:0}).addClass("ui-keyboard-"+j+f+" "+e.css.buttonDefault).html("<span>"+b+"</span>").appendTo(a.temp[0])}; a.buildKeyboard=function(){var c,b,k,h,f,g,j,l,o=0,n=d("<div />").addClass("ui-keyboard "+e.css.container+(e.alwaysOpen?" ui-keyboard-always-open":"")).attr({role:"textbox"}).hide();e.usePreview?(a.$preview=a.$el.clone(!1).removeAttr("id").removeClass("ui-keyboard-placeholder ui-keyboard-input").addClass("ui-keyboard-preview "+e.css.input).attr("tabindex","-1").show(),d("<div />").addClass("ui-keyboard-preview-wrapper").append(a.$preview).appendTo(n)):(a.$preview=a.$el,e.position.at=e.position.at2); e.lockInput&&a.$preview.addClass("ui-keyboard-lockedinput").attr({readonly:"readonly"});if("custom"===e.layout||!d.keyboard.layouts.hasOwnProperty(e.layout))e.layout="custom",d.keyboard.layouts.custom=e.customLayout||{"default":["{cancel}"]};d.each(d.keyboard.layouts[e.layout],function(p,q){if(p!==""){o++;k=d("<div />").attr("name",p).addClass("ui-keyboard-keyset ui-keyboard-keyset-"+p).appendTo(n)[p==="default"?"show":"hide"]();for(b=0;b<q.length;b++){f=d.trim(q[b]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g, "{$1:$2}");j=f.split(/\s+/);for(g=0;g<j.length;g++){a.temp=[k,b,g];h=false;if(j[g].length!==0)if(/^\{\S+\}$/.test(j[g])){c=j[g].match(/^\{(\S+)\}$/)[1].toLowerCase();if(/\!\!/.test(c)){c=c.replace("!!","");h=true}if(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/.test(c)){l=parseFloat(c.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/)[1]||0);d("<span>&nbsp;</span>").width(c.match("px")?l+"px":l*2+"em").addClass("ui-keyboard-button ui-keyboard-spacer").appendTo(k)}if(/^meta\d+\:?(\w+)?/.test(c))a.addKey(c, c);else switch(c){case "a":case "accept":a.addKey("accept",c).addClass(e.css.buttonAction);break;case "alt":case "altgr":a.addKey("alt","alt");break;case "b":case "bksp":a.addKey("bksp",c);break;case "c":case "cancel":a.addKey("cancel",c).addClass(e.css.buttonAction);break;case "combo":a.addKey("combo","combo").addClass(e.css.buttonAction);break;case "dec":a.acceptedKeys.push(a.decimal?".":",");a.addKey("dec","dec");break;case "e":case "enter":a.addKey("enter",c).addClass(e.css.buttonAction);break; case "s":case "shift":a.addKey("shift",c);break;case "sign":a.acceptedKeys.push("-");a.addKey("sign","sign");break;case "space":a.acceptedKeys.push(" ");a.addKey("space","space");break;case "t":case "tab":a.addKey("tab",c);break;default:if(d.keyboard.keyaction.hasOwnProperty(c))a.addKey(c,c)[h?"addClass":"removeClass"](e.css.buttonAction)}}else{a.acceptedKeys.push(j[g].split(":")[0]);a.addKey(j[g],j[g],true)}}k.find(".ui-keyboard-button:last").after('<br class="ui-keyboard-button-endrow">')}}});1< o&&(a.sets=!0);a.hasMappedKeys=!d.isEmptyObject(a.mappedKeys);return n};a.destroy=function(){d(document).unbind("mousedown.keyboard keyup.keyboard");a.$keyboard&&a.$keyboard.remove();var b=d.trim(e.openOn+" accepted beforeClose canceled change contextmenu hidden initialized keydown keypress keyup visible").split(" ").join(".keyboard ");a.$el.removeClass("ui-keyboard-input ui-keyboard-lockedinput ui-keyboard-placeholder ui-keyboard-notallowed ui-keyboard-always-open "+e.css.input).removeAttr("aria-haspopup").removeAttr("role").unbind(b+ ".keyboard").removeData("keyboard")};a.init()};d.keyboard.keyaction={accept:function(b){b.close(!0);return!1},alt:function(b,d){b.altActive=!b.altActive;b.showKeySet(d)},bksp:function(b){b.insertText("bksp")},cancel:function(b){b.close();return!1},clear:function(b){b.$preview.val("")},combo:function(b){var d=!b.options.useCombos;b.options.useCombos=d;b.$keyboard.find(".ui-keyboard-combo")[d?"addClass":"removeClass"](b.options.css.buttonAction);d&&b.checkCombos();return!1},dec:function(b){b.insertText(b.decimal? ".":",")},enter:function(b,l,a){var l=b.el.tagName,e=b.options;if(a.shiftKey)return e.enterNavigation?b.switchInput(!a[e.enterMod],!0):b.close(!0);if(e.enterNavigation&&("TEXTAREA"!==l||a[e.enterMod]))return b.switchInput(!a[e.enterMod],e.autoAccept?"true":!1);"TEXTAREA"===l&&d(a.target).closest("button").length&&b.insertText(" \n")},lock:function(b,d){b.lastKeyset[0]=b.shiftActive=b.capsLock=!b.capsLock;b.showKeySet(d)},meta:function(b,l){b.metaActive=d(l).hasClass(b.options.css.buttonAction)?!1: !0;b.showKeySet(l)},next:function(b){b.switchInput(!0,b.options.autoAccept);return!1},prev:function(b){b.switchInput(!1,b.options.autoAccept);return!1},shift:function(b,d){b.lastKeyset[0]=b.shiftActive=!b.shiftActive;b.showKeySet(d)},sign:function(b){/^\-?\d*\.?\d*$/.test(b.$preview.val())&&b.$preview.val(-1*b.$preview.val())},space:function(b){b.insertText(" ")},tab:function(b){var d=b.options;if("INPUT"===b.el.tagName)return d.tabNavigation?b.switchInput(!b.shiftActive,!0):!1;b.insertText("\t")}}; d.keyboard.layouts={alpha:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}", "{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |", 'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ \u00a1 \u00b2 \u00b3 \u00a4 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00d7 {bksp}","{tab} \u00e4 \u00e5 \u00e9 \u00ae \u00fe \u00fc \u00fa \u00ed \u00f3 \u00f6 \u00ab \u00bb \u00ac","\u00e1 \u00df \u00f0 f g h j k \u00f8 \u00b6 \u00b4 {enter}","{shift} \u00e6 x \u00a9 v b \u00f1 \u00b5 \u00e7 > \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ \u00b9 \u00b2 \u00b3 \u00a3 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00f7 {bksp}", "{tab} \u00c4 \u00c5 \u00c9 \u00ae \u00de \u00dc \u00da \u00cd \u00d3 \u00d6 \u00ab \u00bb \u00a6","\u00c4 \u00a7 \u00d0 F G H J K \u00d8 \u00b0 \u00a8 {enter}","{shift} \u00c6 X \u00a2 V B \u00d1 \u00b5 \u00c7 . \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"]},dvorak:{"default":["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}", '{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{"default":"= ( ) {b};{clear} / * -;7 8 9 +;4 5 6 {sign};1 2 3 %;0 . {a} {c}".split(";")}};d.keyboard.defaultOptions={layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},usePreview:!0,alwaysOpen:!1,stayOpen:!1,display:{a:"\u2714:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"Alt:\u2325 AltGr", b:"\u232b:Backspace",bksp:"Bksp:Backspace",c:"\u2716:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"\u00f6:Toggle Combo Keys",dec:".:Decimal",e:"\u23ce:Enter",enter:"Enter:Enter \u23ce",lock:"Lock:\u21ea Caps Lock",next:"Next \u21e8",prev:"\u21e6 Prev",s:"\u21e7:Shift",shift:"Shift:Shift",sign:"\u00b1:Change Sign",space:"\ufe42\ufe41:Space",t:"\u21e5:Tab",tab:"\u21e5 Tab:Tab"},wheelMessage:"Use mousewheel to see other keys",css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix", buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonDisabled:"ui-state-disabled"},autoAccept:!1,lockInput:!1,restrictInput:!1,acceptValid:!1,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,stickyShift:!0,preventPaste:!1,maxLength:!1,repeatDelay:500,repeatRate:20,resetDefault:!1,openOn:"focus",keyBinding:"mousedown",useCombos:!0,combos:{"`":{a:"\u00e0",A:"\u00c0",e:"\u00e8",E:"\u00c8",i:"\u00ec", I:"\u00cc",o:"\u00f2",O:"\u00d2",u:"\u00f9",U:"\u00d9",y:"\u1ef3",Y:"\u1ef2"},"'":{a:"\u00e1",A:"\u00c1",e:"\u00e9",E:"\u00c9",i:"\u00ed",I:"\u00cd",o:"\u00f3",O:"\u00d3",u:"\u00fa",U:"\u00da",y:"\u00fd",Y:"\u00dd"},'"':{a:"\u00e4",A:"\u00c4",e:"\u00eb",E:"\u00cb",i:"\u00ef",I:"\u00cf",o:"\u00f6",O:"\u00d6",u:"\u00fc",U:"\u00dc",y:"\u00ff",Y:"\u0178"},"^":{a:"\u00e2",A:"\u00c2",e:"\u00ea",E:"\u00ca",i:"\u00ee",I:"\u00ce",o:"\u00f4",O:"\u00d4",u:"\u00fb",U:"\u00db",y:"\u0177",Y:"\u0176"},"~":{a:"\u00e3", A:"\u00c3",e:"\u1ebd",E:"\u1ebc",i:"\u0129",I:"\u0128",o:"\u00f5",O:"\u00d5",u:"\u0169",U:"\u0168",y:"\u1ef9",Y:"\u1ef8",n:"\u00f1",N:"\u00d1"}},validate:function(){return!0}};d.keyboard.comboRegex=/([`\'~\^\"ao])([a-z])/mig;d.keyboard.currentKeyboard="";d.fn.keyboard=function(b){return this.each(function(){d(this).data("keyboard")||new d.keyboard(this,b)})};d.fn.getkeyboard=function(){return this.data("keyboard")}})(jQuery);

(function(d,b,l,a){d.fn.caret=function(e,c){if("undefined"===typeof this[0]||this.is(":hidden")||"hidden"===this.css("visibility"))return this;var d,k,h,f,g,j;d=document.selection;var m=this[0],o=m.scrollTop;j=window.opera&&"[object Opera]"===window.opera.toString();var n="undefined"!==typeof m.selectionStart;"number"===typeof e&&"number"===typeof c&&(h=e,g=c);if("undefined"!==typeof h)return n?("TEXTAREA"===m.tagName&&j&&(j=this.val(),d=j.substring(0,h).split("\n")[b]-1,h+=0<d?d:0,g+=0<d?d:0),m.selectionStart= h,m.selectionEnd=g):(d=m.createTextRange(),d.collapse(!0),d.moveStart("character",h),d.moveEnd("character",g-h),d.select()),(this.is(":visible")||"hidden"!==this.css("visibility"))&&this.focus(),m.scrollTop=o,this;n?(k=m.selectionStart,f=m.selectionEnd,"TEXTAREA"===m.tagName&&j&&(j=this.val(),d=j.substring(0,k).split("\n")[b]-1,k+=0<d?-d:0,f+=0<d?-d:0)):"TEXTAREA"===m.tagName?(j=this.val(),h=d[l](),g=h[a](),g.moveToElementText(m),g.setEndPoint("EndToEnd",h),k=g.text.replace(/\r\n/g,"\r")[b],f=k+h.text.replace(/\r\n/g, "\r")[b]):(j=this.val().replace(/\r\n/g,"\r"),h=d[l]()[a](),h.moveEnd("character",j[b]),k=""===h.text?j[b]:j.lastIndexOf(h.text),h=d[l]()[a](),h.moveStart("character",-j[b]),f=h.text[b]);h=m.value.substring(k,f);return{start:k,end:f,text:h,replace:function(a){return m.value.substring(0,k)+a+m.value.substring(f,m.value[b])}}}})(jQuery,"length","createRange","duplicate");